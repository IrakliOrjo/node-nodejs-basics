(()=>{var e={320:(e,t,r)=>{var n=r(366),o=r(120);function s(){return(new Date).getTime()}var i,a=Array.prototype.slice,u={};i="undefined"!=typeof global&&global.console?global.console:"undefined"!=typeof window&&window.console?window.console:{};for(var d=[[function(){},"log"],[function(){i.log.apply(i,arguments)},"info"],[function(){i.log.apply(i,arguments)},"warn"],[function(){i.warn.apply(i,arguments)},"error"],[function(e){u[e]=s()},"time"],[function(e){var t=u[e];if(!t)throw new Error("No such label: "+e);delete u[e];var r=s()-t;i.log(e+": "+r+"ms")},"timeEnd"],[function(){var e=new Error;e.name="Trace",e.message=n.format.apply(null,arguments),i.error(e.stack)},"trace"],[function(e){i.log(n.inspect(e)+"\n")},"dir"],[function(e){if(!e){var t=a.call(arguments,1);o.ok(!1,n.format.apply(null,t))}},"assert"]],c=0;c<d.length;c++){var l=d[c],f=l[0],p=l[1];i[p]||(i[p]=f)}e.exports=i},512:e=>{var t,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var a,u=[],d=!1,c=-1;function l(){d&&a&&(d=!1,a.length?u=a.concat(u):c=-1,u.length&&f())}function f(){if(!d){var e=i(l);d=!0;for(var t=u.length;t;){for(a=u,u=[];++c<t;)a&&a[c].run();c=-1,t=u.length}a=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function T(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||d||i(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=T,n.addListener=T,n.once=T,n.off=T,n.removeListener=T,n.removeAllListeners=T,n.emit=T,n.prependListener=T,n.prependOnceListener=T,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},712:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.users=void 0,t.users=[]},664:function(e,t,r){"use strict";var n=r(512),o=r(320),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.serveDelete=void 0;const i=r(844),a=s(r(840)),u=r(292);t.serveDelete=function(e,t,r,s){if(a.default.isWorker&&(s=s.data),!(0,i.isValidUUID)(r))return t.statusCode=400,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({message:u.ERROR_MESSAGE.INVALID_UID}));{let e=s.find((e=>e.userId===r));if(!e)return t.statusCode=404,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({message:u.ERROR_MESSAGE.USER_NOT_FOUND}));try{let r=s.findIndex((t=>t.userId===e.userId));return s.splice(r,1),a.default.isWorker&&n.send&&n.send({type:"sharedMemoryUpdate",data:s}),t.statusCode=u.STATUS_CODE.NO_CONTENT,t.setHeader("Content-Type","application/json"),t.end()}catch(e){o.error(e)}}}},944:function(e,t,r){"use strict";var n=r(320),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.serveGetRequest=void 0;const s=o(r(840)),i=r(844),a=r(292);t.serveGetRequest=function(e,t,r,o){if(s.default.isWorker&&(o=o.data),"/"===e.url)t.writeHead(a.STATUS_CODE.OK,{"Content-Type":"text/plain"}),t.end("HOME");else{if("/api/users"!==e.url){if(e.url===`/api/users/${r}`){if(!(0,i.isValidUUID)(r))return t.writeHead(a.STATUS_CODE.BAD_REQUEST,{"Content-Type":"application/json"}),t.end(JSON.stringify({error:a.ERROR_MESSAGE.INVALID_UID}));let e=o.find((e=>e.userId===r));return n.log(e,"user"),e?(t.writeHead(a.STATUS_CODE.OK,{"Content-Type":"application/json"}),t.end(JSON.stringify(e))):(t.writeHead(a.STATUS_CODE.NOT_FOUND,{"Content-Type":"application/json"}),t.end(JSON.stringify({error:a.ERROR_MESSAGE.USER_NOT_FOUND})))}return t.writeHead(a.STATUS_CODE.NOT_FOUND),t.end(a.ERROR_MESSAGE.PAGE_NOT_FOUND)}t.writeHead(a.STATUS_CODE.OK,{"Content-Type":"application/json"}),t.end(JSON.stringify(o))}}},935:function(e,t,r){"use strict";var n=r(512),o=r(320),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.servePostRequest=void 0;const i=r(188),a=r(316),u=s(r(840)),d=r(292);t.servePostRequest=function(e,t,r){u.default.isWorker&&(r=r.data);let s="";e.on("data",(e=>{s+=e.toString()})),e.on("end",(()=>{try{const e=JSON.parse(s);let c={userId:"",username:"",age:0,hobbies:[]};if((0,i.isCorrectUserBodyFormat)(e)){let s=(0,a.createNewUSer)(c,e);return r.unshift(s),u.default.isWorker&&n.send&&n.send({type:"sharedMemoryUpdate",data:r}),o.log(r),t.statusCode=d.STATUS_CODE.OK,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({message:"User added successfully"}))}return t.statusCode=d.STATUS_CODE.BAD_REQUEST,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({error:d.ERROR_MESSAGE.INVALID_DATA}))}catch(e){o.error("Error parsing request body:",e),t.statusCode=d.STATUS_CODE.BAD_REQUEST,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({error:"Error"}))}}))}},540:function(e,t,r){"use strict";var n=r(320),o=r(512),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.servePut=void 0;const i=r(844),a=r(32),u=s(r(840)),d=r(292);t.servePut=function(e,t,r,s){if(u.default.isWorker&&(s=s.data),n.log(s),!(0,i.isValidUUID)(r))return t.statusCode=d.STATUS_CODE.BAD_REQUEST,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({error:d.ERROR_MESSAGE.INVALID_UID}));{let i=s.find((e=>e.userId===r)),c="";e.on("data",(e=>{c+=e.toString()})),e.on("end",(()=>{const e=JSON.parse(c);if(!i)return t.statusCode=d.STATUS_CODE.NOT_FOUND,t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({error:d.ERROR_MESSAGE.USER_NOT_FOUND}));try{return t.statusCode=d.STATUS_CODE.OK,(0,a.updateUser)(i,e),u.default.isWorker&&o.send&&o.send({type:"sharedMemoryUpdate",data:s}),t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({message:"User updated successfully"}))}catch(e){n.log("error: ",e)}}))}}},292:(e,t)=>{"use strict";var r,n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_MESSAGE=t.STATUS_CODE=t.HTTP_METHODS=void 0,function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(r||(t.HTTP_METHODS=r={})),function(e){e[e.OK=200]="OK",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.CREATED=201]="CREATED",e[e.NO_CONTENT=204]="NO_CONTENT"}(n||(t.STATUS_CODE=n={})),function(e){e.INVALID_UID="User is invalid UUId",e.USER_NOT_FOUND="User not found",e.PAGE_NOT_FOUND="Page not found",e.INVALID_DATA="Invalid JSON data",e.TRY_AGAIN="Sorry fo"}(o||(t.ERROR_MESSAGE=o={}))},316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNewUSer=void 0;const n=r(60);t.createNewUSer=function(e,t){return e.userId=(0,n.randomUUID)(),e.username=t.username,e.age=parseInt(t.age),e.hobbies=t.hobbies,e}},188:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCorrectUserBodyFormat=void 0,t.isCorrectUserBodyFormat=function(e){if("string"==typeof e.username&&"string"==typeof e.age&&Array.isArray(e.hobbies)&&3===Object.keys(e).length)return!0}},844:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidUUID=void 0,t.isValidUUID=e=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)},32:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateUser=void 0,t.updateUser=function(e,t){return e.username=t.username,e.age=parseInt(t.age),e.hobbies=t.hobbies,e}},120:e=>{"use strict";e.exports=require("assert")},192:e=>{"use strict";e.exports=require("dotenv/config")},366:e=>{"use strict";e.exports=require("util")},840:e=>{"use strict";e.exports=require("cluster")},60:e=>{"use strict";e.exports=require("node:crypto")},736:e=>{"use strict";e.exports=require("node:http")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";var e=r(320);r(192);const t=r(736),n=r(944),o=r(935),s=r(540),i=r(664),a=r(712);(0,t.createServer)(((e,t)=>{var r;const u=null===(r=null==e?void 0:e.url)||void 0===r?void 0:r.split("/"),d=u&&u[u.length-1];if("GET"===e.method)try{(0,n.serveGetRequest)(e,t,d,a.users)}catch(e){return t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify({error:"Sorry for inconvenience, please try again"}))}else if("POST"===e.method&&"/api/users"===e.url)try{(0,o.servePostRequest)(e,t,a.users)}catch(e){return t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify({error:"Sorry for inconvenience, please try again"}))}else if("PUT"===e.method&&e.url===`/api/users/${d}`)try{(0,s.servePut)(e,t,d,a.users)}catch(e){return t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify({error:"Sorry for inconvenience, please try again"}))}else if("DELETE"===e.method&&e.url===`/api/users/${d}`)try{(0,i.serveDelete)(e,t,d,a.users)}catch(e){return t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify({error:"Sorry for inconvenience, please try again!"}))}})).listen("4000",(()=>e.log("Server server running on 4000")))})()})();